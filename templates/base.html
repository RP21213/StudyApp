<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800&display=swap" rel="stylesheet">

    <title>{% block title %}My Study Hub{% endblock %}</title>

    {% block head %}{% endblock %}
</head>
<body>

    {% block content %}{% endblock %}


    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>

    <script type="module">
  // Import the functions you need from the SDKs you need
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-app.js";
  import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-analytics.js";
  // TODO: Add SDKs for Firebase products that you want to use
  // https://firebase.google.com/docs/web/setup#available-libraries

  // Your web app's Firebase configuration
  // For Firebase JS SDK v7.20.0 and later, measurementId is optional
  const firebaseConfig = {
    apiKey: "AIzaSyA9sJphhDtaoH1S0IgyAzGJP9zvaP7nVho",
    authDomain: "ai-study-hub-f3040.firebaseapp.com",
    projectId: "ai-study-hub-f3040",
    storageBucket: "ai-study-hub-f3040.firebasestorage.app",
    messagingSenderId: "340868632748",
    appId: "1:340868632748:web:57a66c54719aac4d60cf09",
    measurementId: "G-GJR0ZBZ3M7"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const analytics = getAnalytics(app);
</script>

    {% block scripts %}{% endblock %}

    <!-- Global Background Image Support -->
    <script>
        // Initialize background image on all pages
        function initializeGlobalBackground() {
            const currentBackground = '{{ current_user.background_preference or "default" }}';
            applyGlobalBackground(currentBackground);
        }
        
        // Apply background image globally
        function applyGlobalBackground(backgroundName) {
            if (backgroundName === 'default') {
                // Remove any background styling from all elements
                document.body.style.backgroundImage = '';
                document.body.style.backgroundAttachment = '';
                document.body.style.backgroundSize = '';
                document.body.style.backgroundPosition = '';
                document.body.style.backgroundRepeat = '';
                
                const sidebar = document.querySelector('.side-panel');
                const mainContent = document.querySelector('.main-content');
                
                if (sidebar) {
                    sidebar.style.backgroundImage = '';
                    sidebar.style.backgroundAttachment = '';
                    sidebar.style.backgroundSize = '';
                    sidebar.style.backgroundPosition = '';
                    sidebar.style.backgroundRepeat = '';
                }
                
                if (mainContent) {
                    mainContent.style.backgroundImage = '';
                    mainContent.style.backgroundAttachment = '';
                    mainContent.style.backgroundSize = '';
                    mainContent.style.backgroundPosition = '';
                    mainContent.style.backgroundRepeat = '';
                }
                return;
            }
            
            // Apply background image with proper file extension
            const imageExtensions = {
                'citynight': 'citynight.jpg',
                'forest': 'forest.jpg', 
                'mountains': 'mountains.png',
                'nature': 'nature.png',
                'sea': 'sea.png'
            };
            
            const imageFile = imageExtensions[backgroundName] || backgroundName;
            
            // Apply to body and all main containers
            document.body.style.backgroundImage = `url('/static/background-images/${imageFile}')`;
            document.body.style.backgroundAttachment = 'fixed';
            document.body.style.backgroundSize = 'cover';
            document.body.style.backgroundPosition = 'center';
            document.body.style.backgroundRepeat = 'no-repeat';
            
            // Also apply to sidebar and main content areas
            const sidebar = document.querySelector('.side-panel');
            const mainContent = document.querySelector('.main-content');
            
            if (sidebar) {
                sidebar.style.backgroundImage = `url('/static/background-images/${imageFile}')`;
                sidebar.style.backgroundAttachment = 'fixed';
                sidebar.style.backgroundSize = 'cover';
                sidebar.style.backgroundPosition = 'center';
                sidebar.style.backgroundRepeat = 'no-repeat';
            }
            
            if (mainContent) {
                mainContent.style.backgroundImage = `url('/static/background-images/${imageFile}')`;
                mainContent.style.backgroundAttachment = 'fixed';
                mainContent.style.backgroundSize = 'cover';
                mainContent.style.backgroundPosition = 'center';
                mainContent.style.backgroundRepeat = 'no-repeat';
            }
        }
        
        // Initialize background when page loads
        document.addEventListener('DOMContentLoaded', initializeGlobalBackground);
    </script>

</body>
</html>